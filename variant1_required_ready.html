<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Pickalbatros Feedback</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<style>
    body {
      font-family: Arial, sans-serif;
      background: #fefcf9;
      color: #357ABD;
      padding: 20px;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: #fff;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 0 12px rgba(0,0,0,0.1);
    }
    label {
      font-weight: bold;
      margin-top: 20px;
      display: block;
    }
    .rating-group {
      display: flex;
      gap: 15px;
      margin: 10px 0;
    }
    textarea {
      display: block;
      width: 100%;
      max-width: 100%;
      height: 60px;
      margin-top: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      padding: 8px;
    }
    button {
      margin-top: 20px;
      padding: 12px 20px;
      background-color: #1a73e8;
      color: white;
      border: none;
      font-size: 16px;
      border-radius: 5px;
      cursor: pointer;
    }
    .message {
      margin-top: 15px;
      font-weight: bold;
    }
  </style>
</head>
<body>
<div class="container">
<h2>Pickalbatros Feedback Form</h2>
<form id="feedbackForm">
<label>Room Number (starts with 4 or 5):</label>
<input name="Room" pattern="[4-5][0-9]{3}" required="" type="text"/>
<label>Email:</label>
<input name="Email" required="" type="email"/>
<label>Breakfast</label>
<div class="rating-group">
<label><input name="Breakfast" onchange="toggleComment('Breakfast', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Breakfast" onchange="toggleComment('Breakfast', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Breakfast" onchange="toggleComment('Breakfast', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Breakfast" onchange="toggleComment('Breakfast', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Breakfast_comment_container" style="display:none;">
<textarea id="Breakfast_Comment" maxlength="250" minlength="5" name="Breakfast_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Lunch</label>
<div class="rating-group">
<label><input name="Lunch" onchange="toggleComment('Lunch', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Lunch" onchange="toggleComment('Lunch', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Lunch" onchange="toggleComment('Lunch', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Lunch" onchange="toggleComment('Lunch', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Lunch_comment_container" style="display:none;">
<textarea id="Lunch_Comment" maxlength="250" minlength="5" name="Lunch_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Dinner</label>
<div class="rating-group">
<label><input name="Dinner" onchange="toggleComment('Dinner', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Dinner" onchange="toggleComment('Dinner', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Dinner" onchange="toggleComment('Dinner', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Dinner" onchange="toggleComment('Dinner', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Dinner_comment_container" style="display:none;">
<textarea id="Dinner_Comment" maxlength="250" minlength="5" name="Dinner_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Service</label>
<div class="rating-group">
<label><input name="Service" onchange="toggleComment('Service', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Service" onchange="toggleComment('Service', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Service" onchange="toggleComment('Service', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Service" onchange="toggleComment('Service', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Service_comment_container" style="display:none;">
<textarea id="Service_Comment" maxlength="250" minlength="5" name="Service_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Dinner L’Asiatique</label>
<div class="rating-group">
<label><input name="Dinner_LAsiatique" onchange="toggleComment('Dinner_LAsiatique', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Dinner_LAsiatique" onchange="toggleComment('Dinner_LAsiatique', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Dinner_LAsiatique" onchange="toggleComment('Dinner_LAsiatique', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Dinner_LAsiatique" onchange="toggleComment('Dinner_LAsiatique', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Dinner_LAsiatique_comment_container" style="display:none;">
<textarea id="Dinner_LAsiatique_Comment" maxlength="250" minlength="5" name="Dinner_LAsiatique_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Service L’Asiatique</label>
<div class="rating-group">
<label><input name="Service_LAsiatique" onchange="toggleComment('Service_LAsiatique', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Service_LAsiatique" onchange="toggleComment('Service_LAsiatique', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Service_LAsiatique" onchange="toggleComment('Service_LAsiatique', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Service_LAsiatique" onchange="toggleComment('Service_LAsiatique', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Service_LAsiatique_comment_container" style="display:none;">
<textarea id="Service_LAsiatique_Comment" maxlength="250" minlength="5" name="Service_LAsiatique_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Dinner ItalianColonies A-la carte</label>
<div class="rating-group">
<label><input name="Dinner_ItalianColonies" onchange="toggleComment('Dinner_ItalianColonies', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Dinner_ItalianColonies" onchange="toggleComment('Dinner_ItalianColonies', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Dinner_ItalianColonies" onchange="toggleComment('Dinner_ItalianColonies', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Dinner_ItalianColonies" onchange="toggleComment('Dinner_ItalianColonies', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Dinner_ItalianColonies_comment_container" style="display:none;">
<textarea id="Dinner_ItalianColonies_Comment" maxlength="250" minlength="5" name="Dinner_ItalianColonies_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Service ItalianColonies A-la carte</label>
<div class="rating-group">
<label><input name="Service_ItalianColonies" onchange="toggleComment('Service_ItalianColonies', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Service_ItalianColonies" onchange="toggleComment('Service_ItalianColonies', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Service_ItalianColonies" onchange="toggleComment('Service_ItalianColonies', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Service_ItalianColonies" onchange="toggleComment('Service_ItalianColonies', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Service_ItalianColonies_comment_container" style="display:none;">
<textarea id="Service_ItalianColonies_Comment" maxlength="250" minlength="5" name="Service_ItalianColonies_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>FoodCourt</label>
<div class="rating-group">
<label><input name="FoodCourt" onchange="toggleComment('FoodCourt', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="FoodCourt" onchange="toggleComment('FoodCourt', this.value)" type="radio" value="4"/> Good</label>
<label><input name="FoodCourt" onchange="toggleComment('FoodCourt', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="FoodCourt" onchange="toggleComment('FoodCourt', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="FoodCourt_comment_container" style="display:none;">
<textarea id="FoodCourt_Comment" maxlength="250" minlength="5" name="FoodCourt_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>BeachBar</label>
<div class="rating-group">
<label><input name="BeachBar" onchange="toggleComment('BeachBar', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="BeachBar" onchange="toggleComment('BeachBar', this.value)" type="radio" value="4"/> Good</label>
<label><input name="BeachBar" onchange="toggleComment('BeachBar', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="BeachBar" onchange="toggleComment('BeachBar', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="BeachBar_comment_container" style="display:none;">
<textarea id="BeachBar_Comment" maxlength="250" minlength="5" name="BeachBar_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>ColumbusBar</label>
<div class="rating-group">
<label><input name="ColumbusBar" onchange="toggleComment('ColumbusBar', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="ColumbusBar" onchange="toggleComment('ColumbusBar', this.value)" type="radio" value="4"/> Good</label>
<label><input name="ColumbusBar" onchange="toggleComment('ColumbusBar', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="ColumbusBar" onchange="toggleComment('ColumbusBar', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="ColumbusBar_comment_container" style="display:none;">
<textarea id="ColumbusBar_Comment" maxlength="250" minlength="5" name="ColumbusBar_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>OlympusBar</label>
<div class="rating-group">
<label><input name="OlympusBar" onchange="toggleComment('OlympusBar', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="OlympusBar" onchange="toggleComment('OlympusBar', this.value)" type="radio" value="4"/> Good</label>
<label><input name="OlympusBar" onchange="toggleComment('OlympusBar', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="OlympusBar" onchange="toggleComment('OlympusBar', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="OlympusBar_comment_container" style="display:none;">
<textarea id="OlympusBar_Comment" maxlength="250" minlength="5" name="OlympusBar_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>SportBar</label>
<div class="rating-group">
<label><input name="SportBar" onchange="toggleComment('SportBar', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="SportBar" onchange="toggleComment('SportBar', this.value)" type="radio" value="4"/> Good</label>
<label><input name="SportBar" onchange="toggleComment('SportBar', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="SportBar" onchange="toggleComment('SportBar', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="SportBar_comment_container" style="display:none;">
<textarea id="SportBar_Comment" maxlength="250" minlength="5" name="SportBar_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Reception</label>
<div class="rating-group">
<label><input name="Reception" onchange="toggleComment('Reception', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Reception" onchange="toggleComment('Reception', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Reception" onchange="toggleComment('Reception', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Reception" onchange="toggleComment('Reception', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Reception_comment_container" style="display:none;">
<textarea id="Reception_Comment" maxlength="250" minlength="5" name="Reception_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>Luggage</label>
<div class="rating-group">
<label><input name="Luggage" onchange="toggleComment('Luggage', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="Luggage" onchange="toggleComment('Luggage', this.value)" type="radio" value="4"/> Good</label>
<label><input name="Luggage" onchange="toggleComment('Luggage', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="Luggage" onchange="toggleComment('Luggage', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="Luggage_comment_container" style="display:none;">
<textarea id="Luggage_Comment" maxlength="250" minlength="5" name="Luggage_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>GuestRelation</label>
<div class="rating-group">
<label><input name="GuestRelation" onchange="toggleComment('GuestRelation', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="GuestRelation" onchange="toggleComment('GuestRelation', this.value)" type="radio" value="4"/> Good</label>
<label><input name="GuestRelation" onchange="toggleComment('GuestRelation', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="GuestRelation" onchange="toggleComment('GuestRelation', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="GuestRelation_comment_container" style="display:none;">
<textarea id="GuestRelation_Comment" maxlength="250" minlength="5" name="GuestRelation_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>CleanRoom</label>
<div class="rating-group">
<label><input name="CleanRoom" onchange="toggleComment('CleanRoom', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="CleanRoom" onchange="toggleComment('CleanRoom', this.value)" type="radio" value="4"/> Good</label>
<label><input name="CleanRoom" onchange="toggleComment('CleanRoom', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="CleanRoom" onchange="toggleComment('CleanRoom', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="CleanRoom_comment_container" style="display:none;">
<textarea id="CleanRoom_Comment" maxlength="250" minlength="5" name="CleanRoom_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>CleanHotel</label>
<div class="rating-group">
<label><input name="CleanHotel" onchange="toggleComment('CleanHotel', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="CleanHotel" onchange="toggleComment('CleanHotel', this.value)" type="radio" value="4"/> Good</label>
<label><input name="CleanHotel" onchange="toggleComment('CleanHotel', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="CleanHotel" onchange="toggleComment('CleanHotel', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="CleanHotel_comment_container" style="display:none;">
<textarea id="CleanHotel_Comment" maxlength="250" minlength="5" name="CleanHotel_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>CleanBeach</label>
<div class="rating-group">
<label><input name="CleanBeach" onchange="toggleComment('CleanBeach', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="CleanBeach" onchange="toggleComment('CleanBeach', this.value)" type="radio" value="4"/> Good</label>
<label><input name="CleanBeach" onchange="toggleComment('CleanBeach', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="CleanBeach" onchange="toggleComment('CleanBeach', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="CleanBeach_comment_container" style="display:none;">
<textarea id="CleanBeach_Comment" maxlength="250" minlength="5" name="CleanBeach_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>DayProgram</label>
<div class="rating-group">
<label><input name="DayProgram" onchange="toggleComment('DayProgram', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="DayProgram" onchange="toggleComment('DayProgram', this.value)" type="radio" value="4"/> Good</label>
<label><input name="DayProgram" onchange="toggleComment('DayProgram', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="DayProgram" onchange="toggleComment('DayProgram', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="DayProgram_comment_container" style="display:none;">
<textarea id="DayProgram_Comment" maxlength="250" minlength="5" name="DayProgram_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>EveningShow</label>
<div class="rating-group">
<label><input name="EveningShow" onchange="toggleComment('EveningShow', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="EveningShow" onchange="toggleComment('EveningShow', this.value)" type="radio" value="4"/> Good</label>
<label><input name="EveningShow" onchange="toggleComment('EveningShow', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="EveningShow" onchange="toggleComment('EveningShow', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="EveningShow_comment_container" style="display:none;">
<textarea id="EveningShow_Comment" maxlength="250" minlength="5" name="EveningShow_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<label>KidsAnimation</label>
<div class="rating-group">
<label><input name="KidsAnimation" onchange="toggleComment('KidsAnimation', this.value)" required="" type="radio" value="5"/> Very good</label>
<label><input name="KidsAnimation" onchange="toggleComment('KidsAnimation', this.value)" type="radio" value="4"/> Good</label>
<label><input name="KidsAnimation" onchange="toggleComment('KidsAnimation', this.value)" type="radio" value="3"/> Satisfied</label>
<label><input name="KidsAnimation" onchange="toggleComment('KidsAnimation', this.value)" type="radio" value="2"/> Dissatisfied</label>
</div>
<div id="KidsAnimation_comment_container" style="display:none;">
<textarea id="KidsAnimation_Comment" maxlength="250" minlength="5" name="KidsAnimation_Comment" placeholder="If rating is 3 or 2, explain here (up to 250 chars)" required=""></textarea>
</div>
<button type="submit">Submit</button>
<div class="message" id="formMessage"></div>
</form>
</div>
<script>
  function toggleComment(fieldName, value) {
    const commentBox = document.getElementById(fieldName + "_comment_container");
    if (value === "2" || value === "3") {
      commentBox.style.display = "block";
    } else {
      commentBox.style.display = "none";
      document.getElementById(fieldName + "_comment").value = "";
    }
  }
</script>
<script>
    document.getElementById("feedbackForm").addEventListener("submit", async function(e) {
      e.preventDefault();
      const formData = new FormData(e.target);
      const jsonData = {};
      formData.forEach((value, key) => {
        jsonData[key] = value;
      });
      const formMessage = document.getElementById("formMessage");

      try {
        await fetch("https://script.google.com/macros/s/AKfycbw1B4Uh-XfpF1gqjbk7ZtiOgB2T6xzy9fuaQP1TrkyvhWrUrze8uT3ZImxrSqvbkKFo/exec", {
          method: "POST",
          mode: "no-cors",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(jsonData)
        });
        formMessage.textContent = "Thank you! Your feedback has been submitted.";
        formMessage.style.color = "green";
        this.reset();
      } catch (err) {
        formMessage.textContent = "Error submitting form. Please try again.";
        formMessage.style.color = "red";
      }
    });
  </script>
<script>
  function toggleComment(fieldName, value) {
    const commentBox = document.getElementById(fieldName + "_comment_container");
    const textarea = document.getElementById(fieldName + "_Comment");
    if (!commentBox || !textarea) return;

    if (value === "2" || value === "3") {
      commentBox.style.display = "block";
    } else {
      commentBox.style.display = "none";
      textarea.value = "";
    }
  }
<script>
  document.getElementById("feedbackForm").addEventListener("submit", async function(e) {
    e.preventDefault();
    const form = e.target;
    const formData = new FormData(form);
    const commentFields = [
      "Breakfast", "Lunch", "Dinner", "Service", "Dinner_LAsiatique", "Service_LAsiatique",
      "Dinner_ItalianColonies", "Service_ItalianColonies", "FoodCourt", "BeachBar",
      "ColumbusBar", "OlympusBar", "SportBar", "Reception", "Luggage", "GuestRelation",
      "CleanRoom", "CleanHotel", "CleanBeach", "DayProgram", "EveningShow", "KidsAnimation"
    ];

    // проверка: если оценка 2 или 3 — комментарий обязателен
    for (const field of commentFields) {
      const rating = formData.get(field);
      const comment = formData.get(`${field}_Comment`)?.trim() || "";

      if ((rating === "2" || rating === "3") && comment.length < 5) {
        alert(`Please enter at least 5 characters for "${field.replace(/_/g, ' ')}" comment.`);
        document.getElementById(`${field}_Comment`).focus();
        return;
      }
    }

    const jsonData = {};
    formData.forEach((value, key) => {
      jsonData[key] = value;
    });

    const formMessage = document.getElementById("formMessage");

    try {
      await fetch("https://script.google.com/macros/s/AKfycbw1B4Uh-XfpF1gqjbk7ZtiOgB2T6xzy9fuaQP1TrkyvhWrUrze8uT3ZImxrSqvbkKFo/exec", {
        method: "POST",
        mode: "no-cors",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(jsonData)
      });
      formMessage.textContent = "Thank you! Your feedback has been submitted.";
      formMessage.style.color = "green";
      form.reset();
    } catch (err) {
      formMessage.textContent = "Error submitting form. Please try again.";
      formMessage.style.color = "red";
    }
  });
</script>
</body>
</html>
