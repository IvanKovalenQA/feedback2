<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Анкета специалиста</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: url("https://raw.githubusercontent.com/IvanKovalenQA/feedback2/main/pick.jpg")
        no-repeat center center fixed;
      background-size: cover;
    }

    .overlay {
      width: 100%;
      max-width: 820px;
      background: rgba(255, 255, 255, 0.94);
      border-radius: 18px;
      padding: 20px 22px 26px;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.35);
      backdrop-filter: blur(6px);
    }

    @media (min-width: 768px) {
      .overlay {
        padding: 26px 32px 32px;
      }
    }

    h1 {
      margin: 0 0 4px;
      font-size: 1.6rem;
      text-align: center;
    }

    .subtitle {
      text-align: center;
      font-size: 0.92rem;
      opacity: 0.8;
      margin-bottom: 18px;
    }

    /* прогресс-бар */

    .progress-container {
      margin-bottom: 16px;
    }

    .progress-label {
      display: flex;
      justify-content: space-between;
      font-size: 0.8rem;
      margin-bottom: 6px;
      opacity: 0.8;
    }

    .progress-bar {
      width: 100%;
      height: 7px;
      border-radius: 999px;
      background: #e5e5e5;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      width: 0%;
      background: #000;
      border-radius: 999px;
      transition: width 0.3s ease;
    }

    /* шаги */

    .steps {
      position: relative;
    }

    .step {
      display: none;
      animation: fadeIn 0.25s ease;
    }

    .step.active {
      display: block;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(4px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .step-title {
      font-weight: 600;
      margin-bottom: 12px;
      font-size: 1.05rem;
    }

    .step-description {
      font-size: 0.9rem;
      opacity: 0.8;
      margin-bottom: 14px;
    }

    .grid-2 {
      display: grid;
      gap: 10px 18px;
    }

    @media (min-width: 768px) {
      .grid-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    .form-group {
      margin-bottom: 14px;
    }

    label {
      display: block;
      font-size: 0.9rem;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .hint {
      font-size: 0.8rem;
      opacity: 0.7;
      margin-bottom: 4px;
    }

    input[type="text"],
    input[type="tel"],
    input[type="number"],
    textarea,
    select {
      width: 100%;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #d3d3d3;
      font: inherit;
      outline: none;
      transition: border-color 0.18s ease, box-shadow 0.18s ease,
        background-color 0.18s ease;
      background-color: #fafafa;
    }

    input:focus,
    textarea:focus,
    select:focus {
      border-color: #000;
      box-shadow: 0 0 0 1px #0000000f;
      background-color: #fff;
    }

    textarea {
      min-height: 70px;
      resize: vertical;
    }

    .radio-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px 18px;
      margin-top: 4px;
      font-size: 0.9rem;
    }

    .radio-row label {
      font-weight: 400;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .radio-row input[type="radio"] {
      accent-color: #000;
      cursor: pointer;
    }

    .note {
      font-size: 0.82rem;
      opacity: 0.7;
      margin-top: 4px;
    }

    .hidden {
      display: none !important;
    }

    /* навигация */

    .navigation {
      margin-top: 18px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
      flex-wrap: wrap;
    }

    .nav-left,
    .nav-right {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 9px 22px;
      font: inherit;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.12s ease, box-shadow 0.12s ease, opacity 0.12s ease;
      white-space: nowrap;
    }

    .btn-secondary {
      background: #f1f1f1;
      color: #111;
    }

    .btn-primary {
      background: #000;
      color: #fff;
    }

    .btn-ghost {
      background: transparent;
      color: #555;
      padding-left: 0;
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.18);
    }

    button:disabled {
      opacity: 0.5;
      cursor: default;
      transform: none;
      box-shadow: none;
    }

    .summary-list {
      font-size: 0.9rem;
    }

    .summary-item {
      margin-bottom: 10px;
    }

    .summary-label {
      font-weight: 600;
    }

    .summary-value {
      margin-top: 2px;
      white-space: pre-line;
    }

    .success-message {
      margin-top: 12px;
      padding: 10px 12px;
      font-size: 0.9rem;
      background: #f0fdf4;
      border-radius: 10px;
      border: 1px solid #bbf7d0;
    }
  </style>
</head>
<body>
  <div class="overlay">
    <h1>Анкета специалиста</h1>
    <p class="subtitle">
      Ответьте на вопросы, чтобы мы могли чётко описать вашу услугу и ценность
      для клиентов.
    </p>

    <div class="progress-container">
      <div class="progress-label">
        <span id="progress-text">Шаг 1 из 4</span>
        <span id="step-title-short">Контакты</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill"></div>
      </div>
    </div>

    <form id="wizard-form">
      <div class="steps">
        <!-- ШАГ 1: контакты -->
        <section class="step active" data-step="1" data-title-short="Контакты">
          <div class="step-title">Контакты и базовая информация</div>
          <div class="step-description">
            Эти данные помогут нам с вами связаться и корректно указать, как вас
            подписывать.
          </div>

          <div class="grid-2">
            <div class="form-group">
              <label for="name">Имя и фамилия *</label>
              <div class="hint">Так, как вы хотите, чтобы вас указывали в материалах.</div>
              <input type="text" id="name" name="name" required />
            </div>

            <div class="form-group">
              <label for="phone">Номер телефона</label>
              <div class="hint">В формате +7… или +380…</div>
              <input type="tel" id="phone" name="phone" />
            </div>
          </div>

          <div class="form-group">
            <label for="socials">Ссылки на соцсети (если есть)</label>
            <div class="hint">Можно через запятую: Instagram, Telegram, сайт и т.д.</div>
            <textarea
              id="socials"
              name="socials"
              placeholder="Например: @username в Instagram, @username в Telegram, сайт..."
            ></textarea>
          </div>

          <div class="form-group">
            <label for="service">Какую услугу вы предоставляете? *</label>
            <div class="hint">
              Кратко: «психолог-консультант», «коуч по карьерному росту», «астропсихолог» и т.п.
            </div>
            <input type="text" id="service" name="service" required />
          </div>
        </section>

        <!-- ШАГ 2: суть практики -->
        <section class="step" data-step="2" data-title-short="Практика">
          <div class="step-title">Суть вашей практики</div>
          <div class="step-description">
            Здесь важно показать, чем вы реально помогаете людям и каких изменений
            можно ожидать.
          </div>

          <div class="form-group">
            <label for="problems">Какие конкретные проблемы вы помогаете решать? *</label>
            <div class="hint">
              Перечислите 3–7 ключевых запросов: «тревога», «кризис в отношениях», «поиск призвания» и т.п.
            </div>
            <textarea id="problems" name="problems" required></textarea>
          </div>

          <div class="form-group">
            <label for="practice-help">
              Как ваша практика помогает исправить жизнь к лучшему?
            </label>
            <div class="hint">
              Опишите через результат: что меняется в жизни клиента после работы с вами.
            </div>
            <textarea id="practice-help" name="practice_help"></textarea>
          </div>

          <div class="grid-2">
            <div class="form-group">
              <label for="experience">Сколько лет вы занимаетесь этой практикой?</label>
              <div class="hint">Можно округлить до целого числа.</div>
              <input
                type="number"
                id="experience"
                name="experience"
                min="0"
                step="1"
                placeholder="Например: 3"
              />
            </div>

            <div class="form-group">
              <label for="people-count">
                Какому количеству людей вы помогли до сих пор?
              </label>
              <input
                type="number"
                id="people-count"
                name="people_count"
                min="0"
                step="1"
                placeholder="Например: 150"
              />
              <div class="note">Если точно не помните — напишите ориентировочно.</div>
            </div>
          </div>
        </section>

        <!-- ШАГ 3: целевая аудитория -->
        <section class="step" data-step="3" data-title-short="Аудитория">
          <div class="step-title">Кому вы помогаете</div>
          <div class="step-description">
            Эти вопросы помогут чётко описать вашу целевую аудиторию.
          </div>

          <div class="form-group">
            <label>Есть ли возраст, с которым вы не работаете?</label>
            <div class="radio-row">
              <label>
                <input
                  type="radio"
                  name="age-limit-radio"
                  value="нет"
                  checked
                />
                Нет, работаю со всеми возрастами
              </label>
              <label>
                <input
                  type="radio"
                  name="age-limit-radio"
                  value="есть"
                />
                Да, есть ограничения
              </label>
            </div>
            <div
              id="age-limit-details"
              class="form-group hidden"
              style="margin-top: 8px"
            >
              <div class="hint">
                Опишите ограничения по возрасту: «только взрослые от 18 лет», «не работаю
                с подростками» и т.п.
              </div>
              <textarea
                name="age_limit"
                placeholder="Например: работаю только со взрослыми 25–55 лет"
              ></textarea>
            </div>
          </div>

          <div class="form-group">
            <label>Есть ли ограничения по полу клиентов?</label>
            <div class="radio-row">
              <label>
                <input
                  type="radio"
                  name="gender-limit-radio"
                  value="нет"
                  checked
                />
                Нет, работаю со всеми
              </label>
              <label>
                <input
                  type="radio"
                  name="gender-limit-radio"
                  value="женщины"
                />
                Работаю только с женщинами
              </label>
              <label>
                <input
                  type="radio"
                  name="gender-limit-radio"
                  value="мужчины"
                />
                Работаю только с мужчинами
              </label>
              <label>
                <input
                  type="radio"
                  name="gender-limit-radio"
                  value="другое"
                />
                Другое / хочу уточнить
              </label>
            </div>
            <div
              id="gender-limit-details"
              class="form-group hidden"
              style="margin-top: 8px"
            >
              <div class="hint">
                Опишите нюансы: например, что вы проводите отдельные форматы для мужчин
                и женщин.
              </div>
              <textarea name="gender_limit"></textarea>
            </div>
          </div>

          <div class="form-group">
            <label for="ideal-client">
              Опишите «идеального клиента», с которым вы любите работать
            </label>
            <div class="hint">
              Кто это по возрасту, сфере жизни/работы, типичным запросам и состоянию.
            </div>
            <textarea id="ideal-client" name="ideal_client"></textarea>
          </div>
        </section>

        <!-- ШАГ 4: уникальность + обзор -->
        <section class="step" data-step="4" data-title-short="Уникальность">
          <div class="step-title">Ваша уникальность</div>
          <div class="step-description">
            На основе этих ответов можно будет написать сильный текст о вас, как
            о специалисте.
          </div>

          <div class="form-group">
            <label for="difference">
              Чем вы отличаетесь от других специалистов в вашей области? Почему
              человеку стоит пойти к вам, а не к кому-то другому?
            </label>
            <textarea id="difference" name="difference"></textarea>
          </div>

          <div class="form-group">
            <label for="format">
              В каком формате вы обычно работаете с клиентами?
            </label>
            <div class="hint">
              Онлайн/офлайн, индивидуально/группы, разовые сессии или долгий
              процесс и т.п.
            </div>
            <textarea id="format" name="format"></textarea>
          </div>

          <div class="form-group">
            <label>Краткое резюме ваших ответов (для проверки)</label>
            <div class="hint">
              Нажмите «Показать резюме», чтобы посмотреть, как ваши ответы
              собираются в общую картину.
            </div>
            <button
              type="button"
              class="btn-secondary"
              id="show-summary-btn"
              style="margin-top: 6px"
            >
              Показать резюме
            </button>
          </div>

          <div id="summary" class="summary-list hidden"></div>

          <div id="success" class="success-message hidden">
            Форма заполнена! Сейчас данные никуда не отправляются — позже сюда
            можно будет подключить сохранение на сервер или в таблицу.
          </div>
        </section>
      </div>

      <div class="navigation">
        <div class="nav-left">
          <button
            type="button"
            class="btn-secondary"
            id="prev-btn"
            disabled
          >
            ← Назад
          </button>
        </div>
        <div class="nav-right">
          <button type="button" class="btn-ghost" id="skip-btn">
            Пропустить шаг
          </button>
          <button type="button" class="btn-primary" id="next-btn">
            Далее →
          </button>
          <button
            type="submit"
            class="btn-primary hidden"
            id="submit-btn"
          >
            Завершить
          </button>
        </div>
      </div>
    </form>
  </div>

  <script>
    (function () {
      const form = document.getElementById("wizard-form");
      const steps = Array.from(document.querySelectorAll(".step"));
      const prevBtn = document.getElementById("prev-btn");
      const nextBtn = document.getElementById("next-btn");
      const submitBtn = document.getElementById("submit-btn");
      const skipBtn = document.getElementById("skip-btn");
      const progressFill = document.getElementById("progress-fill");
      const progressText = document.getElementById("progress-text");
      const stepTitleShort = document.getElementById("step-title-short");
      const showSummaryBtn = document.getElementById("show-summary-btn");
      const summaryBlock = document.getElementById("summary");
      const successBlock = document.getElementById("success");

      let currentStep = 1;
      const totalSteps = steps.length;

      function updateProgress() {
        const percent = (currentStep / totalSteps) * 100;
        progressFill.style.width = percent + "%";
        progressText.textContent = `Шаг ${currentStep} из ${totalSteps}`;

        const current = steps.find(
          (s) => Number(s.dataset.step) === currentStep
        );
        stepTitleShort.textContent =
          current?.dataset.titleShort || `Шаг ${currentStep}`;
      }

      function showStep(stepNumber) {
        steps.forEach((step) => {
          step.classList.toggle(
            "active",
            Number(step.dataset.step) === stepNumber
          );
        });

        currentStep = stepNumber;
        prevBtn.disabled = currentStep === 1;
        nextBtn.classList.toggle("hidden", currentStep === totalSteps);
        submitBtn.classList.toggle("hidden", currentStep !== totalSteps);

        updateProgress();
      }

      function validateCurrentStep() {
        // Мини-валидация только обязательных полей
        const current = steps.find(
          (s) => Number(s.dataset.step) === currentStep
        );
        const requiredFields = Array.from(
          current.querySelectorAll("[required]")
        );

        for (const field of requiredFields) {
          if (!field.value.trim()) {
            field.focus();
            field.scrollIntoView({ behavior: "smooth", block: "center" });
            return false;
          }
        }

        return true;
      }

      prevBtn.addEventListener("click", () => {
        if (currentStep > 1) {
          showStep(currentStep - 1);
        }
      });

      nextBtn.addEventListener("click", () => {
        if (!validateCurrentStep()) return;
        if (currentStep < totalSteps) {
          showStep(currentStep + 1);
        }
      });

      skipBtn.addEventListener("click", () => {
        if (currentStep < totalSteps) {
          showStep(currentStep + 1);
        }
      });

      // Логика для возрастных ограничений
      const ageRadios = document.querySelectorAll(
        'input[name="age-limit-radio"]'
      );
      const ageLimitDetails = document.getElementById("age-limit-details");

      ageRadios.forEach((radio) => {
        radio.addEventListener("change", () => {
          if (radio.checked && radio.value === "есть") {
            ageLimitDetails.classList.remove("hidden");
          } else if (radio.checked && radio.value === "нет") {
            ageLimitDetails.classList.add("hidden");
          }
        });
      });

      // Логика для ограничений по полу
      const genderRadios = document.querySelectorAll(
        'input[name="gender-limit-radio"]'
      );
      const genderLimitDetails = document.getElementById(
        "gender-limit-details"
      );

      genderRadios.forEach((radio) => {
        radio.addEventListener("change", () => {
          if (radio.checked && radio.value === "другое") {
            genderLimitDetails.classList.remove("hidden");
          } else {
            genderLimitDetails.classList.add("hidden");
          }
        });
      });

      // Резюме ответов
      function buildSummary() {
        const data = new FormData(form);
        const items = [
          ["Имя и фамилия", data.get("name")],
          ["Услуга", data.get("service")],
          ["Телефон", data.get("phone")],
          ["Соцсети", data.get("socials")],
          ["Проблемы клиентов", data.get("problems")],
          [
            "Как практика помогает",
            data.get("practice_help"),
          ],
          ["Опыт (лет)", data.get("experience")],
          [
            "Сколько людей вы уже проконсультировали",
            data.get("people_count"),
          ],
          ["Возрастные ограничения", data.get("age_limit")],
          ["Ограничения по полу", data.get("gender_limit")],
          ["Идеальный клиент", data.get("ideal_client")],
          ["Уникальность", data.get("difference")],
          ["Формат работы", data.get("format")],
        ];

        const html = items
          .filter(
            ([, value]) =>
              value !== null && value !== undefined && String(value).trim() !== ""
          )
          .map(
            ([label, value]) => `
          <div class="summary-item">
            <div class="summary-label">${label}</div>
            <div class="summary-value">${String(value).trim()}</div>
          </div>
        `
          )
          .join("");

        summaryBlock.innerHTML =
          html || "<p>Пока здесь пусто — заполните поля выше.</p>";
      }

      showSummaryBtn.addEventListener("click", () => {
        buildSummary();
        summaryBlock.classList.remove("hidden");
        summaryBlock.scrollIntoView({ behavior: "smooth", block: "start" });
      });

      form.addEventListener("submit", (e) => {
        e.preventDefault();
        if (!validateCurrentStep()) return;

        buildSummary();
        summaryBlock.classList.remove("hidden");
        successBlock.classList.remove("hidden");
        successBlock.scrollIntoView({ behavior: "smooth", block: "start" });

        // Здесь позже можно будет добавить отправку на сервер или в таблицу
        // Например, через fetch(...) или интеграцию с Google Sheets.
      });

      // Инициализация
      updateProgress();
    })();
  </script>
<script>
  (function () {
    // ВСТАВЬ сюда URL из Apps Script веб-приложения
    const SCRIPT_URL = 'https://script.google.com/macros/s/ТВОЙ_URL/exec';

    const form = document.getElementById("wizard-form");
    const steps = Array.from(document.querySelectorAll(".step"));
    const prevBtn = document.getElementById("prev-btn");
    const nextBtn = document.getElementById("next-btn");
    const submitBtn = document.getElementById("submit-btn");
    const skipBtn = document.getElementById("skip-btn");
    const progressFill = document.getElementById("progress-fill");
    const progressText = document.getElementById("progress-text");
    const stepTitleShort = document.getElementById("step-title-short");
    const showSummaryBtn = document.getElementById("show-summary-btn");
    const summaryBlock = document.getElementById("summary");
    const successBlock = document.getElementById("success");

    let currentStep = 1;
    const totalSteps = steps.length;

    function updateProgress() {
      const percent = (currentStep / totalSteps) * 100;
      progressFill.style.width = percent + "%";
      progressText.textContent = `Шаг ${currentStep} из ${totalSteps}`;

      const current = steps.find(
        (s) => Number(s.dataset.step) === currentStep
      );
      stepTitleShort.textContent =
        current?.dataset.titleShort || `Шаг ${currentStep}`;
    }

    function showStep(stepNumber) {
      steps.forEach((step) => {
        step.classList.toggle(
          "active",
          Number(step.dataset.step) === stepNumber
        );
      });

      currentStep = stepNumber;
      prevBtn.disabled = currentStep === 1;
      nextBtn.classList.toggle("hidden", currentStep === totalSteps);
      submitBtn.classList.toggle("hidden", currentStep !== totalSteps);

      updateProgress();
    }

    function validateCurrentStep() {
      const current = steps.find(
        (s) => Number(s.dataset.step) === currentStep
      );
      const requiredFields = Array.from(
        current.querySelectorAll("[required]")
      );

      for (const field of requiredFields) {
        if (!field.value.trim()) {
          field.focus();
          field.scrollIntoView({ behavior: "smooth", block: "center" });
          return false;
        }
      }

      return true;
    }

    prevBtn.addEventListener("click", () => {
      if (currentStep > 1) {
        showStep(currentStep - 1);
      }
    });

    nextBtn.addEventListener("click", () => {
      if (!validateCurrentStep()) return;
      if (currentStep < totalSteps) {
        showStep(currentStep + 1);
      }
    });

    skipBtn.addEventListener("click", () => {
      if (currentStep < totalSteps) {
        showStep(currentStep + 1);
      }
    });

    // Логика для возрастных ограничений
    const ageRadios = document.querySelectorAll(
      'input[name="age-limit-radio"]'
    );
    const ageLimitDetails = document.getElementById("age-limit-details");

    ageRadios.forEach((radio) => {
      radio.addEventListener("change", () => {
        if (radio.checked && radio.value === "есть") {
          ageLimitDetails.classList.remove("hidden");
        } else if (radio.checked && radio.value === "нет") {
          ageLimitDetails.classList.add("hidden");
        }
      });
    });

    // Логика для ограничений по полу
    const genderRadios = document.querySelectorAll(
      'input[name="gender-limit-radio"]'
    );
    const genderLimitDetails = document.getElementById(
      "gender-limit-details"
    );

    genderRadios.forEach((radio) => {
      radio.addEventListener("change", () => {
        if (radio.checked && radio.value === "другое") {
          genderLimitDetails.classList.remove("hidden");
        } else {
          genderLimitDetails.classList.add("hidden");
        }
      });
    });

    // Резюме ответов
    function buildSummary() {
      const data = new FormData(form);
      const items = [
        ["Имя и фамилия", data.get("name")],
        ["Услуга", data.get("service")],
        ["Телефон", data.get("phone")],
        ["Соцсети", data.get("socials")],
        ["Проблемы клиентов", data.get("problems")],
        ["Как практика помогает", data.get("practice_help")],
        ["Опыт (лет)", data.get("experience")],
        [
          "Сколько людей вы уже проконсультировали",
          data.get("people_count"),
        ],
        ["Возрастные ограничения (выбор)", data.get("age-limit-radio")],
        ["Возрастные ограничения (детали)", data.get("age_limit")],
        ["Ограничения по полу (выбор)", data.get("gender-limit-radio")],
        ["Ограничения по полу (детали)", data.get("gender_limit")],
        ["Идеальный клиент", data.get("ideal_client")],
        ["Уникальность", data.get("difference")],
        ["Формат работы", data.get("format")],
      ];

      const html = items
        .filter(
          ([, value]) =>
            value !== null && value !== undefined && String(value).trim() !== ""
        )
        .map(
          ([label, value]) => `
        <div class="summary-item">
          <div class="summary-label">${label}</div>
          <div class="summary-value">${String(value).trim()}</div>
        </div>
      `
        )
        .join("");

      summaryBlock.innerHTML =
        html || "<p>Пока здесь пусто — заполните поля выше.</p>";
    }

    showSummaryBtn.addEventListener("click", () => {
      buildSummary();
      summaryBlock.classList.remove("hidden");
      summaryBlock.scrollIntoView({ behavior: "smooth", block: "start" });
    });

    // ОТПРАВКА В GOOGLE SHEETS
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      if (!validateCurrentStep()) return;

      const formData = new FormData(form);

      submitBtn.disabled = true;
      submitBtn.textContent = "Отправка...";

      try {
        const response = await fetch(SCRIPT_URL, {
          method: "POST",
          body: formData,
        });

        let ok = response.ok;
        let payload = null;
        try {
          payload = await response.json();
        } catch (_) {}

        if (!ok || (payload && payload.status === "error")) {
          throw new Error(
            (payload && payload.message) || "Ошибка при отправке данных"
          );
        }

        buildSummary();
        summaryBlock.classList.remove("hidden");
        successBlock.classList.remove("hidden");
        successBlock.textContent =
          "Готово! Данные успешно отправлены в Google Sheets.";

        successBlock.scrollIntoView({
          behavior: "smooth",
          block: "start",
        });

        // Если нужно — можно очистить форму:
        // form.reset();

      } catch (err) {
        alert(
          "Не удалось отправить данные. Проверь, что веб-приложение опубликовано и доступно всем по ссылке.\n\n" +
            err
        );
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "Завершить";
      }
    });

    // Инициализация
    updateProgress();
  })();
</script>
</body>
</html>
